# åšå®¢ç³»ç»Ÿéƒ¨ç½²æŒ‡å—

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### Dockeréƒ¨ç½²ï¼ˆæ¨èï¼‰

```bash
# ä¸€é”®éƒ¨ç½²
chmod +x docker-setup.sh
./docker-setup.sh

# æˆ–ä½¿ç”¨Makefile
make setup
```

### ä¼ ç»Ÿéƒ¨ç½²

## ç³»ç»Ÿè¦æ±‚

- PHP 7.4 æˆ–æ›´é«˜ç‰ˆæœ¬
- MySQL 5.7 æˆ–æ›´é«˜ç‰ˆæœ¬
- PDO MySQL æ‰©å±•
- WebæœåŠ¡å™¨ (Apache/Nginx)

**æˆ–è€…ä½¿ç”¨Dockerï¼ˆæ¨èï¼‰**ï¼š
- Docker 20.10+
- Docker Compose 2.0+

## æ•°æ®åº“é…ç½®

### 1. åˆ›å»ºæ•°æ®åº“

é¦–å…ˆåœ¨MySQLä¸­åˆ›å»ºæ•°æ®åº“ï¼š

```sql
CREATE DATABASE blog CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

### 2. åˆ›å»ºç”¨æˆ·å¹¶æˆæƒ

```sql
CREATE USER 'wukazi'@'localhost' IDENTIFIED BY 'rewink';
GRANT ALL PRIVILEGES ON blog.* TO 'wukazi'@'localhost';
FLUSH PRIVILEGES;
```

### 3. é…ç½®æ–‡ä»¶è¯´æ˜

æ•°æ®åº“é…ç½®æ–‡ä»¶ä½äº `inc/db.php`ï¼š

```php
$host = 'localhost';     // æ•°æ®åº“ä¸»æœº
$db   = 'blog';         // æ•°æ®åº“åç§°
$user = 'wukazi';       // ç”¨æˆ·å
$pass = 'rewink';       // å¯†ç 
$charset = 'utf8mb4';   // å­—ç¬¦é›†
```

## è®¾ç½®æ­¥éª¤

### Dockeréƒ¨ç½²ï¼ˆæ¨èï¼‰

1. **ä¸€é”®éƒ¨ç½²**
   ```bash
   ./docker-setup.sh
   ```

2. **æ‰‹åŠ¨éƒ¨ç½²**
   ```bash
   # æ„å»ºé•œåƒ
   docker-compose build
   
   # å¯åŠ¨æœåŠ¡
   docker-compose up -d
   
   # æŸ¥çœ‹çŠ¶æ€
   docker-compose ps
   ```

3. **è®¿é—®åº”ç”¨**
   - åšå®¢é¦–é¡µ: http://localhost:8080
   - phpMyAdmin: http://localhost:8081

### ä¼ ç»Ÿéƒ¨ç½²

#### æ­¥éª¤1ï¼šæ£€æŸ¥æ•°æ®åº“è¿æ¥

åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š
```
http://your-domain/check_database.php
```

è¿™å°†æ£€æŸ¥ï¼š
- PHP PDOæ‰©å±•æ˜¯å¦å®‰è£…
- æ•°æ®åº“è¿æ¥æ˜¯å¦æˆåŠŸ
- æ•°æ®åº“è¡¨æ˜¯å¦å­˜åœ¨
- MySQLç‰ˆæœ¬ä¿¡æ¯

#### æ­¥éª¤2ï¼šåˆ›å»ºæ•°æ®åº“è¡¨

åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š
```
http://your-domain/setup_database.php
```

è¿™ä¸ªè„šæœ¬å°†è‡ªåŠ¨åˆ›å»ºä»¥ä¸‹è¡¨ï¼š
- `users` - ç”¨æˆ·è¡¨
- `posts` - æ–‡ç« è¡¨
- `categories` - åˆ†ç±»è¡¨
- `post_categories` - æ–‡ç« åˆ†ç±»å…³è”è¡¨
- `tags` - æ ‡ç­¾è¡¨
- `post_tags` - æ–‡ç« æ ‡ç­¾å…³è”è¡¨
- `comments` - è¯„è®ºè¡¨

#### æ­¥éª¤3ï¼šéªŒè¯è®¾ç½®

è®¾ç½®å®Œæˆåï¼Œè®¿é—®ä¸»é¡µï¼š
```
http://your-domain/index.php
```

## æ•°æ®åº“è¡¨ç»“æ„

### users è¡¨
- `id` - ç”¨æˆ·ID (ä¸»é”®)
- `username` - ç”¨æˆ·å (å”¯ä¸€)
- `password` - å¯†ç  (åŠ å¯†)
- `email` - é‚®ç®± (å”¯ä¸€)
- `created_at` - åˆ›å»ºæ—¶é—´
- `updated_at` - æ›´æ–°æ—¶é—´

### posts è¡¨
- `id` - æ–‡ç« ID (ä¸»é”®)
- `title` - æ–‡ç« æ ‡é¢˜
- `content` - æ–‡ç« å†…å®¹
- `excerpt` - æ–‡ç« æ‘˜è¦
- `author_id` - ä½œè€…ID (å¤–é”®)
- `status` - çŠ¶æ€ (draft/published)
- `created_at` - åˆ›å»ºæ—¶é—´
- `updated_at` - æ›´æ–°æ—¶é—´

### categories è¡¨
- `id` - åˆ†ç±»ID (ä¸»é”®)
- `name` - åˆ†ç±»åç§°
- `slug` - åˆ†ç±»åˆ«å (å”¯ä¸€)
- `description` - åˆ†ç±»æè¿°
- `created_at` - åˆ›å»ºæ—¶é—´

### tags è¡¨
- `id` - æ ‡ç­¾ID (ä¸»é”®)
- `name` - æ ‡ç­¾åç§°
- `slug` - æ ‡ç­¾åˆ«å (å”¯ä¸€)
- `created_at` - åˆ›å»ºæ—¶é—´

### comments è¡¨
- `id` - è¯„è®ºID (ä¸»é”®)
- `post_id` - æ–‡ç« ID (å¤–é”®)
- `author_name` - è¯„è®ºè€…å§“å
- `author_email` - è¯„è®ºè€…é‚®ç®±
- `content` - è¯„è®ºå†…å®¹
- `status` - çŠ¶æ€ (pending/approved/spam)
- `created_at` - åˆ›å»ºæ—¶é—´

## é»˜è®¤è´¦æˆ·

è®¾ç½®å®Œæˆåï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºé»˜è®¤ç®¡ç†å‘˜è´¦æˆ·ï¼š

- **ç”¨æˆ·å**: admin
- **å¯†ç **: admin123
- **é‚®ç®±**: admin@example.com

**é‡è¦æç¤º**: è¯·åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç«‹å³ä¿®æ”¹é»˜è®¤å¯†ç ï¼

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **è¿æ¥è¢«æ‹’ç»**
   - æ£€æŸ¥MySQLæœåŠ¡æ˜¯å¦è¿è¡Œ
   - éªŒè¯ä¸»æœºåœ°å€å’Œç«¯å£

2. **è®¿é—®è¢«æ‹’ç»**
   - æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤ç”¨æˆ·æ˜¯å¦æœ‰æ•°æ®åº“è®¿é—®æƒé™

3. **è¡¨ä¸å­˜åœ¨**
   - è¿è¡Œ `setup_database.php` åˆ›å»ºè¡¨
   - æ£€æŸ¥æ•°æ®åº“åç§°æ˜¯å¦æ­£ç¡®

4. **å­—ç¬¦é›†é—®é¢˜**
   - ç¡®ä¿æ•°æ®åº“ä½¿ç”¨ `utf8mb4` å­—ç¬¦é›†
   - æ£€æŸ¥PHPæ–‡ä»¶æ˜¯å¦ä¿å­˜ä¸ºUTF-8ç¼–ç 

### å®‰å…¨å»ºè®®

1. ä¿®æ”¹é»˜è®¤ç®¡ç†å‘˜å¯†ç 
2. ä½¿ç”¨å¼ºå¯†ç 
3. å®šæœŸå¤‡ä»½æ•°æ®åº“
4. é™åˆ¶æ•°æ®åº“ç”¨æˆ·æƒé™
5. å¯ç”¨SSLè¿æ¥ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

## å¤‡ä»½å’Œæ¢å¤

### å¤‡ä»½æ•°æ®åº“
```bash
mysqldump -u wukazi -p blog > blog_backup.sql
```

### æ¢å¤æ•°æ®åº“
```bash
mysql -u wukazi -p blog < blog_backup.sql
```

## ğŸ³ Dockerç®¡ç†

### å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹å¸®åŠ©
make help

# å¯åŠ¨æœåŠ¡
make up

# åœæ­¢æœåŠ¡
make down

# é‡å¯æœåŠ¡
make restart

# æŸ¥çœ‹æ—¥å¿—
make logs

# è¿›å…¥å®¹å™¨
make shell

# å¤‡ä»½æ•°æ®åº“
make backup

# æ¢å¤æ•°æ®åº“
make restore file=backups/backup_20240101_120000.sql
```

### ç¯å¢ƒé…ç½®

- **å¼€å‘ç¯å¢ƒ**: `docker-compose.dev.yml`
- **ç”Ÿäº§ç¯å¢ƒ**: `docker-compose.prod.yml`
- **è¯¦ç»†è¯´æ˜**: æŸ¥çœ‹ `DOCKER_README.md`

## è”ç³»æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. é”™è¯¯æ—¥å¿—æ–‡ä»¶
2. MySQLé”™è¯¯æ—¥å¿—
3. PHPé”™è¯¯æ—¥å¿—
4. Dockerå®¹å™¨æ—¥å¿—: `docker-compose logs`

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªåŸºç¡€çš„åšå®¢ç³»ç»Ÿï¼Œå»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æ·»åŠ æ›´å¤šçš„å®‰å…¨æªæ–½å’ŒåŠŸèƒ½ã€‚
